---
description: 'Monorepo structure, package organization, and pnpm workspace commands'
alwaysApply: true
---

## Use pnpm monorepo commands

- Use `pnpm run`, `pnpm exec`, `pnpx` and `pnpm --filter <package> <command>`. Not `npm`, `npx` and the likes.
- Use workspace protocol: `workspace:^` for internal dependencies.

## Package namespaces

This monorepo uses **`@ssv/*`** for all packages:

- **`@ssv/frontend`**: Next.js app (packages/frontend)
- **`@ssv/backend`**: Firebase functions / server (packages/backend)
- **`@ssv/schemas`**: Canonical rule sets, validation engine, auto-fix engine, types (packages/schemas)
- **`@ssv/mcp-server`**: MCP server exposing schema & code tools (packages/mcp-server)
- **`@ssv/skill`**: Claude Code / Cursor skill plugin (packages/skill)
- **`@ssv/codegen`**: Zod/Pydantic ↔ JSON Schema conversion, SDK simulation (packages/codegen)
- **`@ssv/audit`**: Shared audit event types and utilities (packages/audit)

### Shared dev tooling (from @codygo-ai npm org)

- **`@codygo-ai/tsconfig`**: Shared TypeScript configs (base, react, node)
- **`@codygo-ai/eslint-config-base`**: Base ESLint config with Prettier, import ordering, mono plugin rules
- **`@codygo-ai/eslint-config-react`**: React ESLint config (extends base, used by frontend)
- **`@codygo-ai/eslint-plugin-mono`**: Custom monorepo ESLint rules (transitive dep)

## Build patterns

- **Libraries** (e.g. `@ssv/schemas`): Build with `tsc` or source imports; `typecheck` with `tsc --noEmit`.
- **Applications** (e.g. `@ssv/frontend`, `@ssv/backend`): Use Next.js or tsup as appropriate; run `build` before deploy.

## Package imports only

Use package imports, not direct file paths across packages:

```typescript
// ✅ CORRECT
import { validateSchemaForRuleSet } from '@ssv/schemas/ruleSetValidator';

// ❌ WRONG
import { validateSchemaForRuleSet } from '../../schemas/src/ruleSetValidator';
```

## Relative paths

- Never use relative paths to other packages. Use workspace protocol (`workspace:^`) in dependencies and import by package name.
- Within a package, use relative paths for same-package imports.

## Dependency management

- Common tooling (TypeScript, ESLint, turbo) is at repo root. Use same major versions across packages.
- Internal deps: `"@ssv/schemas": "workspace:*"` etc.
- Run `pnpm i` at root after any package.json change.
